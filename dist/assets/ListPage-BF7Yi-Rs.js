import{_ as B}from"./ModalConfirm-sC3ACk6i.js";import{g as Y}from"./tag-C21Hr1qT.js";import{I as U,S as q,f as E,g as K,e as F,h as G,i as H,j as J,b as $}from"./ant-design-vue-xZZJ8OSi.js";import{d as M,K as Q,r as _,G as O,b2 as r,e as b,ab as T,bz as s,c as a,ad as y,I as w,i as W,a as X,f as A,F as Z,b0 as ee,ac as te,be as ae}from"./@vue-BAN-rWwc.js";import{_ as P,b as I}from"./index-V-ixwPPj.js";import{g as oe,d as ne}from"./blog-BbT8Vzdo.js";import{i as se}from"./injectionKeys-h8wMimST.js";import{b as re}from"./vue-router-BUdZBcVY.js";import{g as le}from"./axios-CXJOSD7X.js";import{a as ie}from"./@ant-design-CgZh20KY.js";import"./@babel-BiFW4_mA.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./dayjs-D1q64uRo.js";import"./color-convert-C8q6JVNj.js";import"./color-name-sJvbcIHU.js";import"./@ctrl-DOFZgDuz.js";import"./lodash-es-BZQRJuX6.js";import"./throttle-debounce-CUWDS_la.js";import"./vue-types-C5fUfLeo.js";import"./dom-align-CRCehRfe.js";import"./async-validator-CRbnkQr6.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";import"./@tsparticles-DFZjZ4II.js";import"./vuex-ze_3D4wJ.js";import"./vuex-persistedstate-D4njCX8q.js";import"./vue3-cookies-obZ_cbEp.js";import"./vue-lazyload-DLsNfTHF.js";import"./axios--ry0FeSQ.js";const ce=M({components:{AInput:U,ASelect:q,ARangePicker:E,AForm:K,AButton:F},props:{searchState:{type:Object,required:!0},handleSearch:{type:Function,required:!0}},setup(e){const{searchState:l}=Q(e),f=_([]),p=async()=>{const m=await Y();f.value=m.map(n=>({label:n.name,value:n.slug}))},d=(m,[n,o])=>{l.value.start_date=n,l.value.end_date=o};return O(p),{treeData:f,onRangeChange:d}}}),pe={class:"gutter-box"},ue={class:"gutter-box"},de={class:"gutter-box"},me={class:"gutter-box"};function ge(e,l,f,p,d,m){const n=r("a-input"),o=r("a-col"),g=r("a-select"),h=r("a-range-picker"),S=r("a-button"),C=r("a-row"),u=r("a-form");return b(),T(u,{layout:"horizontal",model:e.searchState,onFinish:e.handleSearch},{default:s(()=>[a(C,{gutter:{xs:8,sm:16,md:24,lg:32}},{default:s(()=>[a(o,{class:"gutter-row",span:12},{default:s(()=>[y("div",pe,[a(n,{value:e.searchState.title,"onUpdate:value":l[0]||(l[0]=i=>e.searchState.title=i),"addon-before":"Title"},null,8,["value"])])]),_:1}),a(o,{class:"gutter-row",span:12},{default:s(()=>[y("div",ue,[a(g,{"show-search":"",placeholder:"Select a tag",value:e.searchState.tag,"onUpdate:value":l[1]||(l[1]=i=>e.searchState.tag=i),options:e.treeData,size:"large"},null,8,["value","options"])])]),_:1}),a(o,{class:"gutter-row",span:24},{default:s(()=>[y("div",de,[a(h,{format:"YYYY-MM-DD",onChange:e.onRangeChange},null,8,["onChange"])])]),_:1}),a(o,{class:"gutter-row",span:24},{default:s(()=>[y("div",me,[a(S,{"html-type":"submit",type:"primary"},{default:s(()=>[w("Search")]),_:1})])]),_:1})]),_:1})]),_:1},8,["model","onFinish"])}const V=P(ce,[["render",ge]]),_e=M({components:{CheckOutlined:ie,ModalConfirm:B,SearchComponent:V,ASpace:G,ATag:H,ATable:J,AButton:F},setup(){const e=re(),l=W(se.isLoading),f="Are you sure you want to delete?",p=_(null),d=_(!0),m=_([]),n=_(null),o=_(0),g=_({total:0,pageSize:I}),h=["volcano","geekblue","green","magenta","red","cyan","blue","purple","orange","gold","lime"],S=[{title:"ID",dataIndex:"id",width:"70px"},{title:"Title",dataIndex:"body",ellipsis:!0},{title:"Tags",dataIndex:"tags",width:"300px"},{title:"Operation",dataIndex:"operation",width:"250px"}],C=()=>{const t=Math.floor(Math.random()*h.length);return h[t]},u=async(t=null,c=!1)=>{d.value=!0,i(c,!0),t&&(o.value=t.current);try{const R=(o.value?o.value-1:o.value)*I,N={limit:I,skip:R,...D},L=await oe(N);m.value=L.posts,g.value.total=L.total}catch{$.error("Failed to load data")}finally{d.value=!1,i(c,!1)}},i=(t,c)=>{t&&typeof t=="boolean"&&(l.value=c)},v=async()=>{var t,c,k;try{(t=p.value)==null||t.toggleConfirmLoading(),n.value!==null&&(await ne(n.value),await u()),$.success("Success!")}catch{$.error("Failed to delete blog")}finally{(c=p.value)==null||c.toggleConfirmLoading(),(k=p.value)==null||k.toggleOpen()}},z=t=>{var c;n.value=t,(c=p.value)==null||c.toggleOpen()},j=async t=>{await e.push({name:"admin.blogs.edit",params:{id:t}})},D=X({}),x=()=>{u()};return O(()=>{u(null,!0),le()}),{dataSource:m,columns:S,getRandomColor:C,tableLoading:d,fetchData:u,paginationConfig:g,modalContent:f,modalRef:p,openModal:z,handleConfirmDelete:v,edit:j,searchState:D,handleSearch:x}}}),fe={class:"list-container"},he=y("br",null,null,-1),ve={key:1};function be(e,l,f,p,d,m){const n=V,o=B,g=r("a-button"),h=r("a-space"),S=r("a-tag"),C=r("a-table");return b(),A("div",fe,[a(n,{searchState:e.searchState,handleSearch:e.handleSearch},null,8,["searchState","handleSearch"]),he,a(o,{modalText:e.modalContent,handleOk:e.handleConfirmDelete,ref:"modalRef"},null,8,["modalText","handleOk"]),a(C,{bordered:"","data-source":e.dataSource,columns:e.columns,scroll:{x:1500},loading:e.tableLoading,onChange:e.fetchData,pagination:e.paginationConfig,class:"table line-clamp-2"},{bodyCell:s(({column:u,record:i})=>[u.dataIndex==="operation"?(b(),T(h,{key:0,warp:""},{default:s(()=>[a(g,{type:"primary",onClick:v=>e.edit(i.id)},{default:s(()=>[w("Edit")]),_:2},1032,["onClick"]),a(g,{type:"primary",danger:"",onClick:v=>e.openModal(i.id)},{default:s(()=>[w("Delete")]),_:2},1032,["onClick"])]),_:2},1024)):u.dataIndex==="tags"?(b(),A("span",ve,[(b(!0),A(Z,null,ee(i.tags,v=>(b(),T(S,{key:v,color:e.getRandomColor()},{default:s(()=>[w(ae(v.toUpperCase()),1)]),_:2},1032,["color"]))),128))])):te("",!0)]),_:1},8,["data-source","columns","loading","onChange","pagination"])])}const We=P(_e,[["render",be]]);export{We as default};
