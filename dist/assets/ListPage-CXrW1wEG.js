import{_ as $}from"./ModalConfirm-sC3ACk6i.js";import{s as z,a as P,b as A}from"./axios-CXJOSD7X.js";import{b as w,_ as N}from"./index-V-ixwPPj.js";import{i as x}from"./injectionKeys-h8wMimST.js";import{a as F}from"./@ant-design-CgZh20KY.js";import{I as U,h as E,j as G,e as K,b as O}from"./ant-design-vue-xZZJ8OSi.js";import{d as q,i as H,r as o,G as J,b2 as _,e as L,f as Q,c as k,bz as f,ab as S,ac as B,I as M}from"./@vue-BAN-rWwc.js";import"./axios--ry0FeSQ.js";import"./vue3-cookies-obZ_cbEp.js";import"./vue-router-BUdZBcVY.js";import"./@tsparticles-DFZjZ4II.js";import"./vuex-ze_3D4wJ.js";import"./vuex-persistedstate-D4njCX8q.js";import"./vue-lazyload-DLsNfTHF.js";import"./@ctrl-DOFZgDuz.js";import"./@babel-BiFW4_mA.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./dayjs-D1q64uRo.js";import"./color-convert-C8q6JVNj.js";import"./color-name-sJvbcIHU.js";import"./lodash-es-BZQRJuX6.js";import"./throttle-debounce-CUWDS_la.js";import"./vue-types-C5fUfLeo.js";import"./dom-align-CRCehRfe.js";import"./async-validator-CRbnkQr6.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";const W=async e=>await z(P.get("/comments",{params:e})),X=async e=>await A(P.post("/comments/add",e)),Y=async e=>await A(P.delete("/comments/"+e)),Z=q({components:{CheckOutlined:F,ModalConfirm:$,AInput:U,ASpace:E,ATable:G,AButton:K},setup(){const e=H(x.isLoading),p=o(""),g=o(null),n=o(null),v=o(),y=o(!0),d=o(""),h=o([]),l=o(null),u=o(0),b=o({total:0,pageSize:w}),c=[{title:"ID",dataIndex:"id"},{title:"Title",ellipsis:!0,dataIndex:"body",width:"30%"},{title:"Blog title",ellipsis:!0,dataIndex:"postId"},{title:"Username",dataIndex:"username"},{title:"Operation",dataIndex:"operation"}],s=async(a=null,t=!1)=>{y.value=!0,C(t,!0),a&&(u.value=a.current);try{const I=(u.value?u.value-1:u.value)*w,m=await W({limit:w,skip:I});b.value.total=m.total,h.value=m.comments.map(i=>({id:i.id,body:i.body,postId:i.postId,username:i.user.username}))}catch{O.error("Failed to load data")}finally{y.value=!1,C(t,!1)}},C=(a,t)=>{a&&typeof a=="boolean"&&(e.value=t)},R=async(a,t,r)=>{var I,m,i;try{(I=n.value)==null||I.toggleConfirmLoading(),typeof r=="function"&&await r(),await s(),O.success(a)}catch{O.error(t)}finally{(m=n.value)==null||m.toggleConfirmLoading(),(i=n.value)==null||i.toggleOpen()}},D=async()=>{await R("Success!","Failed to delete blog",()=>Y(l.value).then(()=>Promise.resolve()))},T=async()=>{var a;if(d.value){const t={body:d.value,postId:l.value,userId:1};await R("Success!","Failed to add comment",()=>X(t).then(()=>Promise.resolve()))}else(a=n.value)==null||a.toggleOpen()},V=a=>{var t;p.value="Delete?",g.value=null,l.value=a,(t=n.value)==null||t.toggleOpen(),v.value=D},j=(a,t)=>{var r;d.value="",p.value=t,g.value="Reply comment",l.value=a,(r=n.value)==null||r.toggleOpen(),v.value=T};return J(()=>{s(null,!0)}),{dataSource:h,columns:c,tableLoading:y,fetchData:s,paginationConfig:b,modalContent:p,modalRef:n,openModal:V,openModalReply:j,replyInput:d,modalInputPlaceholder:g,handleOk:v}}}),ee={class:"list-container"};function ae(e,p,g,n,v,y){const d=_("a-input"),h=$,l=_("a-button"),u=_("a-space"),b=_("a-table");return L(),Q("div",ee,[k(h,{modalText:e.modalContent,handleOk:e.handleOk,ref:"modalRef"},{formInput:f(()=>[e.modalInputPlaceholder?(L(),S(d,{key:0,placeholder:e.modalInputPlaceholder,value:e.replyInput,"onUpdate:value":p[0]||(p[0]=c=>e.replyInput=c),maxlength:150,"allow-clear":""},null,8,["placeholder","value"])):B("",!0)]),_:1},8,["modalText","handleOk"]),k(b,{bordered:"","data-source":e.dataSource,columns:e.columns,scroll:{x:1500},loading:e.tableLoading,onChange:e.fetchData,pagination:e.paginationConfig,class:"table"},{bodyCell:f(({column:c,record:s})=>[c.dataIndex==="operation"?(L(),S(u,{key:0,warp:""},{default:f(()=>[k(l,{type:"primary",primary:"",onClick:C=>e.openModalReply(s.id,s.body)},{default:f(()=>[M("Reply")]),_:2},1032,["onClick"]),k(l,{type:"primary",danger:"",onClick:C=>e.openModal(s.id)},{default:f(()=>[M("Delete")]),_:2},1032,["onClick"])]),_:2},1024)):B("",!0)]),_:1},8,["data-source","columns","loading","onChange","pagination"])])}const $e=N(Z,[["render",ae]]);export{$e as default};
